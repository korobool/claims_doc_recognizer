# Laboratory Results Document Schema
# This schema defines the structure for extracting data from lab test results

type_id: lab_results
display_name: Laboratory Results

clip_prompts:
  - "a laboratory test results document"
  - "a blood test or lab report"
  - "medical laboratory results"
  - "a diagnostic test report"

keywords:
  - lab
  - laboratory
  - test
  - result
  - reference
  - range
  - specimen
  - blood
  - urine
  - normal
  - abnormal
  - high
  - low

llm_context: |
  You are processing LABORATORY RESULTS.
  This contains critical medical test data requiring precise extraction.

  Key characteristics:
  - Patient identification
  - Test names and codes
  - Result values with units
  - Reference ranges (normal values)
  - Flags for abnormal results (H=High, L=Low)
  - Collection and report dates

  Common OCR errors:
  - Numeric values are critical - verify decimal places
  - Units must be preserved exactly (mg/dL, mmol/L, etc.)
  - Reference ranges often in parentheses
  - "H" and "L" flags for abnormal values

fields:
  - name: patient_name
    type: person_name
    description: "Patient's name"
    required: true

  - name: patient_dob
    type: date
    description: "Patient's date of birth"
    required: false

  - name: patient_id
    type: text
    description: "Patient ID or medical record number"
    required: false

  - name: collection_date
    type: date
    description: "Date specimen was collected"
    required: true

  - name: collection_time
    type: text
    description: "Time specimen was collected"
    required: false

  - name: report_date
    type: date
    description: "Date results were reported"
    required: false

  - name: ordering_physician
    type: person_name
    description: "Doctor who ordered the tests"
    required: false

  - name: lab_name
    type: text
    description: "Laboratory name"
    required: false

  - name: lab_address
    type: address
    description: "Laboratory address"
    required: false

  - name: specimen_type
    type: text
    description: "Type of specimen (blood, urine, etc.)"
    required: false

  - name: test_results
    type: list
    description: "List of test results with values, units, reference ranges, and flags"
    required: true
    list_item_schema:
      - test_name: "Name of the test"
      - test_code: "Test code if present"
      - result_value: "Numeric or text result"
      - units: "Units of measurement"
      - reference_range: "Normal reference range"
      - flag: "Abnormal flag (H=High, L=Low, C=Critical)"
      - is_abnormal: "Whether result is outside normal range"

  - name: critical_values
    type: list
    description: "Any critical values that require immediate attention"
    required: false

  - name: comments
    type: text
    description: "Lab comments or notes"
    required: false

  - name: fasting_status
    type: text
    description: "Whether patient was fasting"
    required: false
